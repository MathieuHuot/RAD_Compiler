\begin{abstract}
Our work aims at bridging the gap between high-level functional reverse-mode differentiation and efficient imperative implementations.
We define a new source-to-source transformation for reverse-mode differentiation on a standard higher-order purely functional language. 
Using a logical relations argument, we prove our transformation correct using diffeological spaces as a denotational semantics for our language. 
We then show that combining our macro with some classical optimisations lead to low-level SSA-like code, which is as efficient as low-level imperative implementations. 
We prove some theoretical complexity guarantees and provide experimental results which showcase the efficiency of our method. 
\end{abstract}